<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice2Barcode Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Voice2Barcode Dashboard</h1>
        <div id="dashboardContent">
            <p>Welcome to the Voice2Barcode app!</p>

            <!-- Mode Switching Section -->
            <div class="input-switch">
                <button class="btn mode-btn active" data-mode="voice">Voice</button>
                <button class="btn mode-btn" data-mode="text">Text</button>
                <button class="btn mode-btn" data-mode="upload">Upload</button>
            </div>

            <!-- Voice Recording Section -->
            <div id="voiceInput" class="section" style="display: block;">
                <button id="recordBtn" class="btn record">üé§ Record</button>
                <button id="stopBtn" class="btn stop" disabled>‚èπ Stop</button>
                <div id="audioContainer"></div>
            </div>

            <!-- Recording Indicator -->
            <div id="recordingIndicator" style="display: none;" class="recording-indicator"></div>
            <div id="status" class="status"></div>

            <!-- Text Input Section -->
           <!-- Text Input Section -->
<div id="textInput" class="section" style="display: none;">
    <textarea id="textToConvert" placeholder="Enter text (max 200 characters)" maxlength="200"></textarea>
    <div class="voice-selection">
        <select id="maleVoiceSelect" class="voice-select">
            <option value="">Select Male Voice</option>
        </select>
        <select id="femaleVoiceSelect" class="voice-select">
            <option value="">Select Female Voice</option>
        </select>
    </div>
    <button id="textConvertBtn" class="btn">Generate Audio QR</button>
    <div id="ttsStatus" class="status"></div>
</div>

            <!-- Audio Upload Section -->
            <input type="file" id="audioUpload" accept="audio/*" style="display: none;">
            <label for="audioUpload" class="btn">Upload Audio File</label>

            <!-- QR Code Upload Section -->
            <input type="file" id="qrUpload" accept="image/png, image/jpeg" style="display: none;">
            <label for="qrUpload" class="btn">Upload QR Code</label>

            <!-- Section for displaying decoded content -->
            <div id="scannedContent" class="section" style="display: none;">
                <p>Scanned Message: <span id="messageText"></span></p>
                <div id="scannedAudio"></div>
            </div>

            <!-- Section for displaying the generated QR code -->
            <div id="generatedQRCode" class="section">
                <div id="qrcode"></div>
                <button id="downloadQRCodeBtn" class="btn" disabled>‚¨á Download QR Code</button>
            </div>

            <!-- QR Code Scanning Section -->
            <div class="section">
                <button id="scanBtn" class="btn scan">üîç Scan QR Code</button>
                <!-- Camera Preview -->
                <div id="cameraPreview" class="camera-preview" style="display: none;">
                    <video id="cameraFeed" autoplay playsinline></video>
                </div>
                <button id="switchCameraBtn" style="display:none;">Switch Camera</button>
                <button id="downloadBtn" class="btn download" disabled>‚¨á Download Content</button>
            </div>

            <!-- Log Out Button -->
            <button id="logoutBtn" class="btn" style="display: none;">Log Out</button>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>¬© 2024 Voice2Barcode. All rights reserved.</p>
            <div class="footer-links">
                <a href="#" class="footer-link">Privacy Policy</a>
                <a href="#" class="footer-link">Terms of Service</a>
                <a href="#" class="footer-link">GitHub Repo</a>
            </div>
        </div>
    </footer>

    <!-- External Libraries (UPDATED) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.0/build/qrcode.min.js"></script>
<script type="module">
    import { OpusEncoder } from 'https://cdn.jsdelivr.net/npm/@opus-encoder/encoder@6.1.0/+esm';
    window.OpusEncoder = OpusEncoder;
</script>
    
    <!-- Your Custom JS Files (PRESERVED AS-IS) -->
    <script src="js/audioRecordingCompressionQR.js"></script>
    <script src="js/QRCodeUploadHandling.js"></script>
    <script src="js/ModeSwitching.js"></script>
    <script src="js/SecurityHandler.js"></script>
    <script src="js/tts.js"></script>
    <script src="js/QRScanning.js"></script>
    <script src="js/main.js"></script>

    <script>
        // Authorization check (UPDATED)
        (function() {
            if (!localStorage.getItem('loggedInUser')) {
                window.location.href = 'signin.html';
            }
            document.getElementById('logoutBtn').style.display = 'inline-block';
        })();

        // Logout handler (UPDATED)
        document.getElementById('logoutBtn').addEventListener('click', () => {
            localStorage.removeItem('loggedInUser');
            window.location.href = 'signin.html';
        });
    </script>
</body>
</html>
